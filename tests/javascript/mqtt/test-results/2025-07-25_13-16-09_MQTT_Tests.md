# MQTT Test Suite Results

## Overall Summary

- **Test Run Start**: 2025-07-25T13:16:09.384Z
- **Test Run End**: 2025-07-25T13:16:26.597Z
- **Total Duration**: 17213ms
- **Total Tests**: 0
- **Total Logs**: 34
- **Total Errors**: 9
- **Total Warnings**: 1

## Test Results Summary

| Test Name | Status | Duration | Logs | Errors | Warnings |
|-----------|--------|----------|------|--------|----------|

## Overall Metrics

- **Total Connections**: 0
- **Total Disconnections**: 0
- **Total Messages Sent**: 0
- **Total Messages Received**: 0
- **Total Errors**: 0
- **Total Warnings**: 0

## All Errors

### Error 1 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:11.445Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 2 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:14.308Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 3 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:17.191Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 4 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:19.510Z
- **Test**: MQTT Connection Tests
- **Message**: Connection test timeout
- **Error Name**: Error
- **Error Message**: Connection timeout
- **Stack Trace**: 
```
Error: Connection timeout
    at Timeout._onTimeout (/app/javascript/mqtt/connection.test.js:89:23)
    at listOnTimeout (node:internal/timers:569:17)
    at processTimers (node:internal/timers:512:7)
```

### Error 5 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:20.067Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 6 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:22.950Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 7 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:25.830Z
- **Test**: MQTT Connection Tests
- **Message**: Expected connection error
- **Error Name**: Error
- **Error Message**: getaddrinfo ENOTFOUND non-existent-broker
- **Stack Trace**: 
```
Error: getaddrinfo ENOTFOUND non-existent-broker
    at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:107:26)
```

### Error 8 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:26.448Z
- **Test**: MQTT Connection Tests
- **Message**: Reconnection test timeout
- **Error Name**: Error
- **Error Message**: Reconnection timeout
- **Stack Trace**: 
```
Error: Reconnection timeout
    at Timeout._onTimeout (/app/javascript/mqtt/connection.test.js:198:23)
    at listOnTimeout (node:internal/timers:569:17)
    at processTimers (node:internal/timers:512:7)
```

### Error 9 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:26.454Z
- **Test**: MQTT Connection Tests
- **Message**: Authentication should have failed
- **Error Name**: Error
- **Error Message**: Expected authentication to fail
- **Stack Trace**: 
```
Error: Expected authentication to fail
    at MqttClient.<anonymous> (/app/javascript/mqtt/connection.test.js:241:23)
    at MqttClient.emit (node:events:529:35)
    at Readable.<anonymous> (/app/node_modules/mqtt/src/lib/client.ts:2373:11)
    at Readable.emit (node:events:517:28)
    at endReadableNT (/app/node_modules/readable-stream/lib/internal/streams/readable.js:1233:12)
    at processTicksAndRejections (node:internal/process/task_queues:82:21)
```

## All Warnings

### Warning 1 (MQTT Connection Tests)

- **Time**: 2025-07-25T13:16:26.454Z
- **Test**: MQTT Connection Tests
- **Message**: Unexpected successful authentication with invalid credentials

## Detailed Logs

| Time | Test | Level | Message | Data |
|------|------|-------|---------|------|
| 13:16:09 | MQTT Connection Tests | INFO | Test Step: Starting connection test to actual Mosquitto broker |  |
| 13:16:09 | MQTT Connection Tests | INFO | Creating MQTT client | {"host":"mosquitto","port":1883,"clientId":"test-connection-1753449369384","username":"admin"} |
| 13:16:09 | MQTT Connection Tests | INFO | MQTT Connection established | {"clientId":"test-connection-1753449369384","host":"mosquitto","port":1883,"success":true,"timestamp":"2025-07-25T13:16:09.559Z"} |
| 13:16:09 | MQTT Connection Tests | INFO | Performance: Connection Response Time | {"value":175,"unit":"ms","timestamp":"2025-07-25T13:16:09.559Z"} |
| 13:16:09 | MQTT Connection Tests | INFO | Assertion: Client should be connected | {"passed":true,"expected":true,"actual":true} |
| 13:16:09 | MQTT Connection Tests | INFO | Assertion: Response time should be less than 5000ms | {"passed":true,"expected":"< 5000ms","actual":"175ms"} |
| 13:16:09 | MQTT Connection Tests | INFO | Test Step: Testing connection failure handling with non-existent broker |  |
| 13:16:09 | MQTT Connection Tests | INFO | Attempting connection to non-existent broker | {"host":"non-existent-broker","port":1883,"clientId":"test-failure-1753449369581"} |
| 13:16:11 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:11.445Z"} |
| 13:16:11 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:11 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:11 | MQTT Connection Tests | INFO | Test Step: Testing reconnection after connection loss |  |
| 13:16:11 | MQTT Connection Tests | INFO | Creating MQTT client with reconnection enabled | {"host":"mosquitto","port":1883,"clientId":"test-reconnect-1753449371447","clean":false,"reconnectPeriod":1000} |
| 13:16:11 | MQTT Connection Tests | INFO | MQTT Connection established | {"clientId":"test-reconnect-1753449371447","host":"mosquitto","port":1883,"success":true,"timestamp":"2025-07-25T13:16:11.450Z"} |
| 13:16:11 | MQTT Connection Tests | INFO | Connection attempt 1 successful |  |
| 13:16:11 | MQTT Connection Tests | INFO | Test Step: Simulating connection loss by calling client.end() |  |
| 13:16:14 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:14.308Z"} |
| 13:16:14 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:14 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:14 | MQTT Connection Tests | INFO | Connection failed as expected |  |
| 13:16:17 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:17.191Z"} |
| 13:16:17 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:17 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:20 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:20.067Z"} |
| 13:16:20 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:20 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:22 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:22.950Z"} |
| 13:16:22 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:22 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:25 | MQTT Connection Tests | INFO | MQTT Connection failed | {"clientId":"test-failure-1753449369581","host":"non-existent-broker","port":1883,"success":false,"timestamp":"2025-07-25T13:16:25.830Z"} |
| 13:16:25 | MQTT Connection Tests | INFO | Assertion: Error should be defined | {"passed":true,"expected":true,"actual":true} |
| 13:16:25 | MQTT Connection Tests | INFO | Assertion: Client should not be connected | {"passed":true,"expected":false,"actual":false} |
| 13:16:26 | MQTT Connection Tests | INFO | Test Step: Testing authentication failure with invalid credentials |  |
| 13:16:26 | MQTT Connection Tests | INFO | Attempting connection with invalid credentials | {"host":"mosquitto","port":1883,"clientId":"test-auth-failure-1753449386452","username":"invalid_user"} |
