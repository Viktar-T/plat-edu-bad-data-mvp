# MQTT Test Suite Results

## Overall Summary

- **Test Run Start**: 2025-07-25T13:15:53.938Z
- **Test Run End**: 2025-07-25T13:15:54.637Z
- **Total Duration**: 699ms
- **Total Tests**: 0
- **Total Logs**: 49
- **Total Errors**: 7
- **Total Warnings**: 2

## Test Results Summary

| Test Name | Status | Duration | Logs | Errors | Warnings |
|-----------|--------|----------|------|--------|----------|

## Overall Metrics

- **Total Connections**: 0
- **Total Disconnections**: 0
- **Total Messages Sent**: 0
- **Total Messages Received**: 0
- **Total Errors**: 0
- **Total Warnings**: 0

## All Errors

### Error 1 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.093Z
- **Test**: Service Health Check Tests
- **Message**: InfluxDB health check failed
- **Error Name**: TypeError
- **Error Message**: expect(...).toBeOneOf is not a function
- **Stack Trace**: 
```
TypeError: expect(...).toBeOneOf is not a function
    at Object.toBeOneOf (/app/javascript/health/service-health.test.js:150:31)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
```

### Error 2 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.110Z
- **Test**: Service Health Check Tests
- **Message**: Assertion: InfluxDB should be accessible

### Error 3 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.147Z
- **Test**: Service Health Check Tests
- **Message**: Grafana health check failed
- **Error Name**: TypeError
- **Error Message**: expect(...).toBeOneOf is not a function
- **Stack Trace**: 
```
TypeError: expect(...).toBeOneOf is not a function
    at Object.toBeOneOf (/app/javascript/health/service-health.test.js:237:31)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
```

### Error 4 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.147Z
- **Test**: Service Health Check Tests
- **Message**: Assertion: Grafana should be accessible

### Error 5 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.274Z
- **Test**: Service Health Check Tests
- **Message**: Assertion: Mosquitto MQTT port should be accessible

### Error 6 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.379Z
- **Test**: Service Health Check Tests
- **Message**: Assertion: Mosquitto WebSocket port should be accessible

### Error 7 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.416Z
- **Test**: Service Health Check Tests
- **Message**: Assertion: All critical service ports should be accessible

## All Warnings

### Warning 1 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.274Z
- **Test**: Service Health Check Tests
- **Message**: Mosquitto MQTT port test failed
- **Data**: 
```json
{
  "error": "read ECONNRESET"
}
```

### Warning 2 (Service Health Check Tests)

- **Time**: 2025-07-25T13:15:54.379Z
- **Test**: Service Health Check Tests
- **Message**: Mosquitto WebSocket port test failed
- **Data**: 
```json
{
  "error": "socket hang up"
}
```

## Detailed Logs

| Time | Test | Level | Message | Data |
|------|------|-------|---------|------|
| 13:15:53 | Service Health Check Tests | INFO | Test Step: Testing Mosquitto MQTT broker health |  |
| 13:15:53 | Service Health Check Tests | INFO | Attempting connection to Mosquitto broker | {"host":"mosquitto","port":1883,"clientId":"health-check-1753449353939"} |
| 13:15:54 | Service Health Check Tests | INFO | MQTT Connection established | {"clientId":"health-check-1753449353939","host":"mosquitto","port":1883,"success":true,"timestamp":"2025-07-25T13:15:54.060Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Mosquitto Connection Response Time | {"value":14,"unit":"ms","timestamp":"2025-07-25T13:15:54.060Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Mosquitto connected, testing message publishing |  |
| 13:15:54 | Service Health Check Tests | INFO | Topic Subscription successful | {"topic":"system/health/test","qos":1,"success":true,"timestamp":"2025-07-25T13:15:54.063Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Message Received | {"topic":"system/health/test","payload":"health-check-ping","qos":1,"timestamp":"2025-07-25T13:15:54.066Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Mosquitto message round-trip should work | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Mosquitto should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | MQTT Disconnection | {"clientId":"health-check-1753449353939","reason":"Health check completed","timestamp":"2025-07-25T13:15:54.068Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Testing InfluxDB health |  |
| 13:15:54 | Service Health Check Tests | INFO | Attempting to connect to InfluxDB | {"url":"http://influxdb:8086/health"} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: InfluxDB Health Check Response Time | {"value":20,"unit":"ms","timestamp":"2025-07-25T13:15:54.092Z"} |
| 13:15:54 | Service Health Check Tests | INFO | InfluxDB health check response | {"status":200,"statusText":"OK","data":"OK"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: InfluxDB should be healthy | {"passed":true,"expected":"200 or 204","actual":200} |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Testing Node-RED health |  |
| 13:15:54 | Service Health Check Tests | INFO | Attempting to connect to Node-RED | {"url":"http://node-red:1880"} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Node-RED Health Check Response Time | {"value":5,"unit":"ms","timestamp":"2025-07-25T13:15:54.118Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Node-RED health check response | {"status":200,"statusText":"OK","contentType":"text/html; charset=utf-8"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Node-RED should be healthy | {"passed":true,"expected":200,"actual":200} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Node-RED response time should be acceptable | {"passed":true,"expected":"< 5000ms","actual":"5ms"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Node-RED should return valid content | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Testing Grafana health |  |
| 13:15:54 | Service Health Check Tests | INFO | Attempting to connect to Grafana | {"url":"http://grafana:3000"} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Grafana Health Check Response Time | {"value":24,"unit":"ms","timestamp":"2025-07-25T13:15:54.146Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Grafana health check response | {"status":200,"statusText":"OK","contentType":"text/html; charset=UTF-8"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Grafana should be healthy | {"passed":true,"expected":"200 or 302","actual":200} |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Comprehensive health check of all services |  |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Comprehensive Health Check Total Time | {"value":34,"unit":"ms","timestamp":"2025-07-25T13:15:54.183Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Comprehensive health check results | {"mosquitto":true,"influxdb":true,"nodeRed":true,"grafana":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: mosquitto should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: influxdb should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: nodeRed should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: grafana should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: All services should be healthy | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Health check summary: 4/4 services healthy |  |
| 13:15:54 | Service Health Check Tests | INFO | Test Step: Testing service port accessibility |  |
| 13:15:54 | Service Health Check Tests | INFO | Testing port accessibility for Mosquitto MQTT | {"host":"mosquitto","port":1883} |
| 13:15:54 | Service Health Check Tests | INFO | Testing port accessibility for Mosquitto WebSocket | {"host":"mosquitto","port":9001} |
| 13:15:54 | Service Health Check Tests | INFO | Testing port accessibility for InfluxDB | {"host":"influxdb","port":8086} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: InfluxDB Port Response Time | {"value":4,"unit":"ms","timestamp":"2025-07-25T13:15:54.383Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: InfluxDB port should be accessible | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Testing port accessibility for Node-RED | {"host":"node-red","port":1880} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Node-RED Port Response Time | {"value":4,"unit":"ms","timestamp":"2025-07-25T13:15:54.387Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Node-RED port should be accessible | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Testing port accessibility for Grafana | {"host":"grafana","port":3000} |
| 13:15:54 | Service Health Check Tests | INFO | Performance: Grafana Port Response Time | {"value":29,"unit":"ms","timestamp":"2025-07-25T13:15:54.416Z"} |
| 13:15:54 | Service Health Check Tests | INFO | Assertion: Grafana port should be accessible | {"passed":true,"expected":true,"actual":true} |
| 13:15:54 | Service Health Check Tests | INFO | Port accessibility test results | {"Mosquitto MQTT":{"accessible":false,"error":"read ECONNRESET"},"Mosquitto WebSocket":{"accessible":false,"error":"socket hang up"},"InfluxDB":{"accessible":true,"responseTime":4},"Node-RED":{"accessible":true,"responseTime":4},"Grafana":{"accessible":true,"responseTime":29}} |
