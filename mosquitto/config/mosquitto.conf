# Mosquitto MQTT Broker Configuration
# IoT Renewable Energy Monitoring System

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# MQTT Port
listener 1883
protocol mqtt

# WebSocket Port
listener 9001
protocol websockets

# Maximum number of concurrent connections
max_connections 1000

# Connection timeout
connection_messages true
log_timestamp true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Allow anonymous connections (disable for production)
allow_anonymous true

# Password file (uncomment for production)
# password_file /mosquitto/config/password_file

# Access Control List (uncomment for production)
# acl_file /mosquitto/config/acl_file

# Certificate files for SSL/TLS (uncomment for production)
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log types
log_type all
log_timestamp true
log_dest stdout
log_dest file /mosquitto/log/mosquitto.log

# Log levels
# none, error, warning, notice, information, debug, subscribe, unsubscribe, websockets
log_type error
log_type warning
log_type notice
log_type information

# =============================================================================
# PERSISTENCE CONFIGURATION
# =============================================================================

# Persistence
persistence true
persistence_location /mosquitto/data/

# Autosave interval
autosave_interval 1800

# Autosave on changes
autosave_on_changes false

# =============================================================================
# MESSAGE CONFIGURATION
# =============================================================================

# Retained messages
allow_duplicate_messages false
max_inflight_messages 20
max_queued_messages 100

# Message size limit
message_size_limit 0

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

# Memory limit
max_packet_size 0

# Queue size
max_queued_messages 100

# =============================================================================
# BRIDGE CONFIGURATION (Optional)
# =============================================================================

# Bridge to external MQTT broker (uncomment if needed)
# connection bridge-1
# address external-broker.com:1883
# topic devices/+/+/telemetry out 1 "" devices/
# topic devices/+/+/status out 1 "" devices/
# topic devices/+/+/config in 1 "" devices/

# =============================================================================
# PLUGIN CONFIGURATION (Optional)
# =============================================================================

# Plugin path
# plugin /mosquitto/lib/mosquitto_plugin.so

# =============================================================================
# CUSTOM SETTINGS
# =============================================================================

# Custom topic patterns for renewable energy devices
# These are handled by the application logic

# Device telemetry topics
# devices/photovoltaic/{device_id}/telemetry
# devices/wind_turbine/{device_id}/telemetry
# devices/biogas_plant/{device_id}/telemetry
# devices/heat_boiler/{device_id}/telemetry
# devices/energy_storage/{device_id}/telemetry

# Device status topics
# devices/{device_type}/{device_id}/status

# Device configuration topics
# devices/{device_type}/{device_id}/config

# System health topics
# system/health/{service_name}
# system/alerts/{severity} 